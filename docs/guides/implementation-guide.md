# Руководство внедренца Integration Broker

## Для кого эта инструкция

Для инженера внедрения, который разворачивает Integration Broker у заказчика и готовит систему к запуску.

## Что нужно заранее

- Java 21+
- PostgreSQL
- Доступ к внешним системам (VisitManager, DataBus, CRM, МИС, система записи)
- Keycloak (если используется защищённый режим)

## Порядок внедрения

1. Поднимите базу данных и примените миграции.
2. Заполните `application.yml`.
3. Настройте runtime-конфигурацию и коннекторы.
4. Подключите flow и Groovy-скрипты.
5. Проверьте стартовые проверки (fail-fast).
6. Прогоните smoke-тесты на примерах из `src/main/resources/examples`.

## Обязательные настройки интеграции

- Передавайте `X-Correlation-Id` и `X-Request-Id` во внешние вызовы.
- Для servicepoint-сценариев учитывайте cookie `sid`.
- Для DataBus всегда задавайте служебные заголовки (например `Service-Sender`, `Send-Date`).

## Чек-лист перед go-live

- [ ] Проверены ключевые API и метрики.
- [ ] Проверен replay для DLQ и outbox.
- [ ] Проверено, что секреты не попадают в логи.
- [ ] Проверены таймауты и повторы для внешних сервисов.
- [ ] Подготовлены инструкции для поддержки.

## Практический совет

Если у заказчика часто меняются правила обработки, держите эти правила в flow/Groovy, а не в Java-коде. Так изменения можно внедрять быстрее и безопаснее.
