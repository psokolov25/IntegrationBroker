# Руководство пользователя Integration Broker

## Для кого эта инструкция

Для сотрудника, который работает с системой на ежедневной основе: отправляет события, смотрит статус обработки и при необходимости запускает повторную отправку.

## Что можно делать в системе

1. Передавать входящие события в Integration Broker.
2. Проверять, прошло ли сообщение успешно.
3. Смотреть проблемные сообщения.
4. Запускать повторную обработку после исправления причины ошибки.

## Простой рабочий сценарий

### Шаг 1. Отправьте событие

Отправьте запрос в `POST /api/inbound`.
Можно взять готовый пример из `src/main/resources/examples/sample-inbound-visit.created.json`.

### Шаг 2. Проверьте результат

Проверьте метрики в `GET /api/metrics/integration`.
Если нужно, проверьте статус по ключу идемпотентности.

### Шаг 3. Если есть ошибка

1. Откройте запись в DLQ.
2. Исправьте входные данные или настройки.
3. Запустите replay (повторную обработку).

## Полезные API

- `POST /api/inbound`
- `GET /api/metrics/integration`
- `GET /admin/idempotency/{key}`
- `GET /admin/dlq/{id}`
- `POST /admin/dlq/{id}/replay`
- `GET /admin/outbox/messaging/{id}`
- `POST /admin/outbox/messaging/{id}/replay`
- `GET /admin/outbox/rest/{id}`
- `POST /admin/outbox/rest/{id}/replay`

## Правила безопасной работы

- Не копируйте токены и пароли в тикеты и переписку.
- Для разбора инцидента используйте `correlationId` и `requestId`.
- Если ошибка повторяется, сразу передайте кейс в поддержку L2.
